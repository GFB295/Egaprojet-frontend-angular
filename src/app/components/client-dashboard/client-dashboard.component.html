<!-- Interface Client EGA Bank -->
<div class="client-dashboard">
  <!-- Header -->
  <header class="dashboard-header">
    <div class="header-content">
      <div class="logo-section">
        <h1>üè¶ EGA BANK</h1>
        <span class="tagline">Votre banque digitale</span>
      </div>
      <div class="user-section">
        <div class="user-info" *ngIf="client">
          <span class="welcome">Bonjour, {{ client.prenom }} {{ client.nom }}</span>
          <span class="user-role">Client</span>
        </div>
        <button class="logout-btn" (click)="logout()">
          üö™ D√©connexion
        </button>
      </div>
    </div>
  </header>

  <!-- Loading State -->
  <div *ngIf="isLoading" class="loading-container">
    <div class="spinner"></div>
    <p>Chargement de votre espace client...</p>
  </div>

  <!-- Error State -->
  <div *ngIf="!isLoading && errorMessage" class="error-container">
    <div class="error-icon">‚ö†Ô∏è</div>
    <h3>Erreur</h3>
    <p>{{ errorMessage }}</p>
    <button class="btn-retry" (click)="loadClientData()">R√©essayer</button>
  </div>

  <!-- Success Message -->
  <div *ngIf="successMessage" class="success-banner">
    <span class="success-icon">‚úÖ</span>
    {{ successMessage }}
  </div>

  <!-- Main Dashboard -->
  <div *ngIf="!isLoading && !errorMessage && client" class="dashboard-content">
    
    <!-- Vue d'ensemble -->
    <section class="overview-section">
      <h2>üìä Vue d'ensemble</h2>
      <div class="overview-cards">
        <div class="overview-card total-balance">
          <div class="card-icon">üí∞</div>
          <div class="card-content">
            <h3>Solde total</h3>
            <div class="amount">{{ formatCurrency(getTotalSolde()) }}</div>
          </div>
        </div>
        <div class="overview-card accounts-count">
          <div class="card-icon">üè¶</div>
          <div class="card-content">
            <h3>Mes comptes</h3>
            <div class="count">{{ comptes.length }} compte(s)</div>
          </div>
        </div>
        <div class="overview-card transactions-count">
          <div class="card-icon">üìà</div>
          <div class="card-content">
            <h3>Transactions r√©centes</h3>
            <div class="count">{{ recentTransactions.length }} transaction(s)</div>
          </div>
        </div>
      </div>
    </section>

    <!-- Actions rapides -->
    <section class="quick-actions-section">
      <h2>‚ö° Actions rapides</h2>
      <div class="quick-actions">
        <button class="action-btn primary" (click)="openDepotForm()">
          <span class="btn-icon">‚¨áÔ∏è</span>
          <span class="btn-text">Effectuer un d√©p√¥t</span>
        </button>
        <button class="action-btn secondary" (click)="openRetraitForm()">
          <span class="btn-icon">‚¨ÜÔ∏è</span>
          <span class="btn-text">Effectuer un retrait</span>
        </button>
        <button class="action-btn tertiary" (click)="openVirementForm()">
          <span class="btn-icon">‚ÜîÔ∏è</span>
          <span class="btn-text">Faire un virement</span>
        </button>
        <button class="action-btn quaternary" (click)="openReleveForm()">
          <span class="btn-icon">üìÑ</span>
          <span class="btn-text">T√©l√©charger relev√©</span>
        </button>
      </div>
    </section>

    <!-- Mes comptes -->
    <section class="accounts-section">
      <div class="section-header">
        <h2>üí≥ Mes comptes bancaires</h2>
        <button class="btn-create-account" (click)="openCreateAccountForm()">
          ‚ûï Cr√©er un compte
        </button>
      </div>
      
      <div *ngIf="comptes.length === 0" class="empty-state">
        <div class="empty-icon">üè¶</div>
        <h3>Aucun compte</h3>
        <p>Vous n'avez pas encore de compte bancaire.</p>
        <button class="btn-primary" (click)="openCreateAccountForm()">
          Cr√©er mon premier compte
        </button>
      </div>
      
      <div *ngIf="comptes.length > 0" class="accounts-grid">
        <div *ngFor="let compte of comptes" class="account-card" [class]="compte.typeCompte.toLowerCase()">
          <div class="account-header">
            <div class="account-type">
              <span class="type-icon">{{ compte.typeCompte === 'COURANT' ? 'üè¶' : 'üí∞' }}</span>
              <span class="type-label">{{ compte.typeCompte === 'COURANT' ? 'Compte Courant' : 'Compte √âpargne' }}</span>
            </div>
            <div class="account-balance">{{ formatCurrency(compte.solde) }}</div>
          </div>
          <div class="account-details">
            <div class="account-number">{{ compte.numeroCompte }}</div>
            <div class="account-date">Ouvert le {{ formatDate(compte.dateCreation) }}</div>
          </div>
          <div class="account-actions">
            <button class="btn-small" (click)="depotForm.numeroCompte = compte.numeroCompte; openDepotForm()">
              D√©p√¥t
            </button>
            <button class="btn-small" (click)="retraitForm.numeroCompte = compte.numeroCompte; openRetraitForm()">
              Retrait
            </button>
            <button class="btn-small" (click)="releveForm.numeroCompte = compte.numeroCompte; openReleveForm()">
              Relev√©
            </button>
          </div>
        </div>
      </div>
    </section>

    <!-- Transactions r√©centes -->
    <section class="transactions-section">
      <h2>üìä Transactions r√©centes</h2>
      
      <div *ngIf="recentTransactions.length === 0" class="empty-state">
        <div class="empty-icon">üìà</div>
        <h3>Aucune transaction</h3>
        <p>Vous n'avez pas encore effectu√© de transactions.</p>
      </div>
      
      <div *ngIf="recentTransactions.length > 0" class="transactions-list">
        <div *ngFor="let transaction of recentTransactions" 
             class="transaction-item" 
             [class]="'transaction-' + transaction.typeTransaction.toLowerCase()">
          <div class="transaction-icon">
            <span *ngIf="transaction.typeTransaction === 'DEPOT'">‚¨áÔ∏è</span>
            <span *ngIf="transaction.typeTransaction === 'RETRAIT'">‚¨ÜÔ∏è</span>
            <span *ngIf="transaction.typeTransaction === 'VIREMENT'">‚ÜîÔ∏è</span>
          </div>
          <div class="transaction-details">
            <div class="transaction-type">{{ getTransactionTypeLabel(transaction.typeTransaction) }}</div>
            <div class="transaction-date">{{ formatDateTime(transaction.dateTransaction) }}</div>
            <div class="transaction-account">{{ transaction.compteNumero }}</div>
            <div class="transaction-description" *ngIf="transaction.description">{{ transaction.description }}</div>
          </div>
          <div class="transaction-amount" [class]="transaction.typeTransaction === 'DEPOT' ? 'positive' : 'negative'">
            <span class="amount-sign">{{ transaction.typeTransaction === 'DEPOT' ? '+' : '-' }}</span>
            <span class="amount-value">{{ formatCurrency(transaction.montant) }}</span>
          </div>
        </div>
      </div>
    </section>

    <!-- Informations client -->
    <section class="client-info-section">
      <h2>üë§ Mes informations</h2>
      <div class="client-info-card">
        <div class="info-grid">
          <div class="info-item">
            <label>Nom complet</label>
            <span>{{ client.nom }} {{ client.prenom }}</span>
          </div>
          <div class="info-item">
            <label>Email</label>
            <span>{{ client.courriel }}</span>
          </div>
          <div class="info-item">
            <label>T√©l√©phone</label>
            <span>{{ client.telephone }}</span>
          </div>
          <div class="info-item">
            <label>Date de naissance</label>
            <span>{{ formatDate(client.dateNaissance) }}</span>
          </div>
          <div class="info-item full-width">
            <label>Adresse</label>
            <span>{{ client.adresse }}</span>
          </div>
          <div class="info-item">
            <label>Nationalit√©</label>
            <span>{{ client.nationalite }}</span>
          </div>
        </div>
      </div>
    </section>
  </div>

  <!-- MODALS -->

  <!-- Modal D√©p√¥t -->
  <div *ngIf="showDepotForm" class="modal-overlay" (click)="closeDepotForm()">
    <div class="modal" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h3>‚¨áÔ∏è Effectuer un d√©p√¥t</h3>
        <button class="modal-close" (click)="closeDepotForm()">√ó</button>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <label>Compte √† cr√©diter</label>
          <select [(ngModel)]="depotForm.numeroCompte" class="form-input">
            <option *ngFor="let compte of comptes" [value]="compte.numeroCompte">
              {{ compte.numeroCompte }} - {{ compte.typeCompte }} ({{ formatCurrency(compte.solde) }})
            </option>
          </select>
        </div>
        <div class="form-group">
          <label>Montant (‚Ç¨)</label>
          <input type="number" [(ngModel)]="depotForm.montant" class="form-input" min="0.01" step="0.01" />
        </div>
        <div class="form-group">
          <label>Description (optionnel)</label>
          <input type="text" [(ngModel)]="depotForm.description" class="form-input" placeholder="Ex: Salaire, remboursement..." />
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn-secondary" (click)="closeDepotForm()">Annuler</button>
        <button class="btn-primary" (click)="effectuerDepot()">Effectuer le d√©p√¥t</button>
      </div>
    </div>
  </div>

  <!-- Modal Retrait -->
  <div *ngIf="showRetraitForm" class="modal-overlay" (click)="closeRetraitForm()">
    <div class="modal" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h3>‚¨ÜÔ∏è Effectuer un retrait</h3>
        <button class="modal-close" (click)="closeRetraitForm()">√ó</button>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <label>Compte √† d√©biter</label>
          <select [(ngModel)]="retraitForm.numeroCompte" class="form-input">
            <option *ngFor="let compte of comptes" [value]="compte.numeroCompte">
              {{ compte.numeroCompte }} - {{ compte.typeCompte }} ({{ formatCurrency(compte.solde) }})
            </option>
          </select>
        </div>
        <div class="form-group">
          <label>Montant (‚Ç¨)</label>
          <input type="number" [(ngModel)]="retraitForm.montant" class="form-input" min="0.01" step="0.01" />
        </div>
        <div class="form-group">
          <label>Description (optionnel)</label>
          <input type="text" [(ngModel)]="retraitForm.description" class="form-input" placeholder="Ex: Achat, frais..." />
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn-secondary" (click)="closeRetraitForm()">Annuler</button>
        <button class="btn-primary" (click)="effectuerRetrait()">Effectuer le retrait</button>
      </div>
    </div>
  </div>

  <!-- Modal Virement -->
  <div *ngIf="showVirementForm" class="modal-overlay" (click)="closeVirementForm()">
    <div class="modal" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h3>‚ÜîÔ∏è Effectuer un virement</h3>
        <button class="modal-close" (click)="closeVirementForm()">√ó</button>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <label>Compte source</label>
          <select [(ngModel)]="virementForm.compteSource" class="form-input">
            <option *ngFor="let compte of comptes" [value]="compte.numeroCompte">
              {{ compte.numeroCompte }} - {{ compte.typeCompte }} ({{ formatCurrency(compte.solde) }})
            </option>
          </select>
        </div>
        <div class="form-group">
          <label>Compte destinataire (IBAN)</label>
          <input type="text" [(ngModel)]="virementForm.compteDestinataire" class="form-input" 
                 placeholder="FR76 1234 5678 9012 3456 7890 123" />
        </div>
        <div class="form-group">
          <label>Montant (‚Ç¨)</label>
          <input type="number" [(ngModel)]="virementForm.montant" class="form-input" min="0.01" step="0.01" />
        </div>
        <div class="form-group">
          <label>Description (optionnel)</label>
          <input type="text" [(ngModel)]="virementForm.description" class="form-input" placeholder="Ex: Remboursement, cadeau..." />
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn-secondary" (click)="closeVirementForm()">Annuler</button>
        <button class="btn-primary" (click)="effectuerVirement()">Effectuer le virement</button>
      </div>
    </div>
  </div>

  <!-- Modal Relev√© PDF -->
  <div *ngIf="showReleveForm" class="modal-overlay" (click)="closeReleveForm()">
    <div class="modal" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h3>üìÑ T√©l√©charger le relev√© PDF</h3>
        <button class="modal-close" (click)="closeReleveForm()">√ó</button>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <label>Compte</label>
          <select [(ngModel)]="releveForm.numeroCompte" class="form-input">
            <option *ngFor="let compte of comptes" [value]="compte.numeroCompte">
              {{ compte.numeroCompte }} - {{ compte.typeCompte }}
            </option>
          </select>
        </div>
        <div class="form-group">
          <label>Date de d√©but</label>
          <input type="date" [(ngModel)]="releveForm.dateDebut" class="form-input" />
        </div>
        <div class="form-group">
          <label>Date de fin</label>
          <input type="date" [(ngModel)]="releveForm.dateFin" class="form-input" />
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn-secondary" (click)="closeReleveForm()">Annuler</button>
        <button class="btn-primary" (click)="downloadRelevePDF()">T√©l√©charger PDF</button>
      </div>
    </div>
  </div>

  <!-- Modal Cr√©ation de compte -->
  <div *ngIf="showCreateAccountForm" class="modal-overlay" (click)="closeCreateAccountForm()">
    <div class="modal" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h3>‚ûï Cr√©er un nouveau compte</h3>
        <button class="modal-close" (click)="closeCreateAccountForm()">√ó</button>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <label>Type de compte</label>
          <select [(ngModel)]="createAccountForm.typeCompte" class="form-input">
            <option value="COURANT">üè¶ Compte Courant</option>
            <option value="EPARGNE">üí∞ Compte √âpargne</option>
          </select>
        </div>
        <div class="info-box">
          <p><strong>Informations importantes :</strong></p>
          <ul>
            <li>Le num√©ro IBAN sera g√©n√©r√© automatiquement</li>
            <li>Le solde initial sera de 0.00 ‚Ç¨</li>
            <li>Vous pourrez effectuer un premier d√©p√¥t apr√®s cr√©ation</li>
          </ul>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn-secondary" (click)="closeCreateAccountForm()">Annuler</button>
        <button class="btn-primary" (click)="creerCompte()">Cr√©er le compte</button>
      </div>
    </div>
  </div>
</div>