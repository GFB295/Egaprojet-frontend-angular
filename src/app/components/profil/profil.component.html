<!-- Interface Client EGA Bank - Version SimplifiÃ©e -->
<div class="client-interface">
  <!-- Header -->
  <header class="client-header">
    <h1>ğŸ¦ EGA BANK - Espace Client</h1>
    <div class="user-info" *ngIf="client">
      <span>Bonjour {{ client.prenom }} {{ client.nom }}</span>
      <button class="logout-btn" (click)="logout()">DÃ©connexion</button>
    </div>
  </header>

  <!-- Loading -->
  <div *ngIf="isLoading" class="loading">
    <div class="spinner"></div>
    <p>Chargement de votre espace client...</p>
  </div>

  <!-- Error -->
  <div *ngIf="!isLoading && errorMessage" class="error">
    <h3>âŒ Erreur</h3>
    <p>{{ errorMessage }}</p>
    <button (click)="reloadData()">RÃ©essayer</button>
  </div>

  <!-- Success Message (masquÃ©) -->
  <div *ngIf="false" class="success">
    âœ… {{ successMessage }}
  </div>

  <!-- Main Content -->
  <div *ngIf="client" class="client-content">
    
    <!-- Vue d'ensemble -->
    <section class="overview">
      <h2>ğŸ“Š Vue d'ensemble</h2>
      <div class="overview-cards">
        <div class="card">
          <h3>ğŸ’° Solde total</h3>
          <div class="amount" [class.empty-total]="getTotalSolde() === 0">
            <span *ngIf="getTotalSolde() === 0" class="empty-total-text">
              Aucun solde disponible
            </span>
            <span *ngIf="getTotalSolde() > 0">
              {{ formatCurrencySimple(getTotalSolde()) }}
            </span>
          </div>
        </div>
        <div class="card">
          <h3>ğŸ¦ Mes comptes</h3>
          <div class="count">{{ comptes.length }} compte(s)</div>
        </div>
        <div class="card">
          <h3>ğŸ“ˆ Transactions</h3>
          <div class="count">{{ recentTransactions.length }} rÃ©cente(s)</div>
        </div>
      </div>
    </section>

    <!-- Actions rapides -->
    <section class="actions">
      <h2>âš¡ Actions rapides</h2>
      <div class="action-buttons">
        <button class="btn-action depot" (click)="openDepotForm()">
          â¬‡ï¸ DÃ©pÃ´t
        </button>
        <button class="btn-action retrait" (click)="openRetraitForm()">
          â¬†ï¸ Retrait
        </button>
        <button class="btn-action virement" (click)="openVirementForm()">
          â†”ï¸ Virement
        </button>
        <button class="btn-action releve" (click)="openReleveForm()">
          ğŸ“„ RelevÃ© PDF
        </button>
        <button class="btn-action create" (click)="openCreateAccountForm()">
          â• Nouveau compte
        </button>
        <button class="btn-action reset" (click)="resetAllData()" title="Supprimer toutes les donnÃ©es et repartir Ã  zÃ©ro">
          ğŸ—‘ï¸ Tout rÃ©initialiser
        </button>
      </div>
    </section>

    <!-- Mes comptes -->
    <section class="accounts">
      <h2>ğŸ’³ Mes comptes bancaires</h2>
      
      <div *ngIf="comptes.length === 0" class="empty">
        <p>Aucun compte bancaire</p>
        <button class="btn-primary" (click)="openCreateAccountForm()">
          CrÃ©er mon premier compte
        </button>
      </div>
      
      <div *ngIf="comptes.length > 0" class="accounts-list">
        <div *ngFor="let compte of comptes" class="account-item">
          <div class="account-info">
            <div class="account-type">
              {{ compte.typeCompte === 'COURANT' ? 'ğŸ¦ Compte Courant' : 'ğŸ’° Compte Ã‰pargne' }}
            </div>
            <div class="account-number">{{ compte.numeroCompte }}</div>
            <div class="account-balance" [class.empty-balance]="!compte.solde || compte.solde === 0">
              <span *ngIf="!compte.solde || compte.solde === 0" class="empty-text">
                Compte vide - Effectuez un dÃ©pÃ´t pour commencer
              </span>
              <span *ngIf="compte.solde && compte.solde > 0" class="balance-amount">
                {{ formatCurrencySimple(compte.solde) }}
              </span>
            </div>
            <div class="account-date">Ouvert le {{ formatDate(compte.dateCreation) }}</div>
          </div>
          <div class="account-actions">
            <button (click)="depotForm.numeroCompte = compte.numeroCompte; openDepotForm()">DÃ©pÃ´t</button>
            <button (click)="retraitForm.numeroCompte = compte.numeroCompte; openRetraitForm()" 
                    [disabled]="!compte.solde || compte.solde === 0">Retrait</button>
            <button (click)="releveForm.numeroCompte = compte.numeroCompte; openReleveForm()">RelevÃ©</button>
          </div>
        </div>
      </div>
    </section>

    <!-- Transactions rÃ©centes -->
    <section class="transactions">
      <h2>ğŸ“Š Transactions rÃ©centes</h2>
      
      <div *ngIf="recentTransactions.length === 0" class="empty">
        <p>Aucune transaction rÃ©cente</p>
      </div>
      
      <div *ngIf="recentTransactions.length > 0" class="transactions-list">
        <div *ngFor="let transaction of recentTransactions" class="transaction-item">
          <div class="transaction-icon">
            <span *ngIf="transaction.typeTransaction === 'DEPOT'">â¬‡ï¸</span>
            <span *ngIf="transaction.typeTransaction === 'RETRAIT'">â¬†ï¸</span>
            <span *ngIf="transaction.typeTransaction === 'VIREMENT'">â†”ï¸</span>
          </div>
          <div class="transaction-details">
            <div class="transaction-type">{{ getTransactionTypeLabel(transaction.typeTransaction) }}</div>
            <div class="transaction-date">{{ formatDateTime(transaction.dateTransaction) }}</div>
            <div class="transaction-account">{{ transaction.compteNumero }}</div>
          </div>
          <div class="transaction-amount" [class]="transaction.typeTransaction === 'DEPOT' ? 'positive' : 'negative'">
            {{ transaction.typeTransaction === 'DEPOT' ? '+' : '-' }}{{ formatCurrency(transaction.montant) }}
          </div>
        </div>
      </div>
    </section>

    <!-- Informations client -->
    <section class="client-info">
      <h2>ğŸ‘¤ Mes informations</h2>
      <div class="info-grid">
        <div class="info-item">
          <label>Nom complet</label>
          <span>{{ client.nom }} {{ client.prenom }}</span>
        </div>
        <div class="info-item">
          <label>Email</label>
          <span>{{ client.courriel }}</span>
        </div>
        <div class="info-item">
          <label>TÃ©lÃ©phone</label>
          <span>{{ client.telephone }}</span>
        </div>
        <div class="info-item">
          <label>Date de naissance</label>
          <span>{{ formatDate(client.dateNaissance) }}</span>
        </div>
        <div class="info-item full-width">
          <label>Adresse</label>
          <span>{{ client.adresse }}</span>
        </div>
        <div class="info-item">
          <label>NationalitÃ©</label>
          <span>{{ client.nationalite }}</span>
        </div>
      </div>
    </section>
  </div>

  <!-- MODALS SIMPLIFIÃ‰S -->

  <!-- Modal DÃ©pÃ´t -->
  <div *ngIf="showDepotForm" class="modal-overlay" (click)="closeDepotForm()">
    <div class="modal" (click)="$event.stopPropagation()">
      <h3>â¬‡ï¸ Effectuer un dÃ©pÃ´t</h3>
      <div class="form-group">
        <label>Compte</label>
        <select [(ngModel)]="depotForm.numeroCompte">
          <option *ngFor="let compte of comptes" [value]="compte.numeroCompte">
            {{ compte.numeroCompte }} - {{ compte.typeCompte }}
          </option>
        </select>
      </div>
      <div class="form-group">
        <label>Montant (â‚¬)</label>
        <input type="number" [(ngModel)]="depotForm.montant" min="0.01" step="0.01" />
      </div>
      <div class="form-group">
        <label>Description</label>
        <input type="text" [(ngModel)]="depotForm.description" placeholder="Optionnel" />
      </div>
      <div class="modal-actions">
        <button (click)="closeDepotForm()">Annuler</button>
        <button (click)="effectuerDepot()" class="btn-primary">Effectuer</button>
      </div>
    </div>
  </div>

  <!-- Modal Retrait -->
  <div *ngIf="showRetraitForm" class="modal-overlay" (click)="closeRetraitForm()">
    <div class="modal" (click)="$event.stopPropagation()">
      <h3>â¬†ï¸ Effectuer un retrait</h3>
      <div class="form-group">
        <label>Compte</label>
        <select [(ngModel)]="retraitForm.numeroCompte">
          <option *ngFor="let compte of comptes" [value]="compte.numeroCompte">
            {{ compte.numeroCompte }} - {{ compte.typeCompte }}
          </option>
        </select>
      </div>
      <div class="form-group">
        <label>Montant (â‚¬)</label>
        <input type="number" [(ngModel)]="retraitForm.montant" min="0.01" step="0.01" />
      </div>
      <div class="form-group">
        <label>Description</label>
        <input type="text" [(ngModel)]="retraitForm.description" placeholder="Optionnel" />
      </div>
      <div class="modal-actions">
        <button (click)="closeRetraitForm()">Annuler</button>
        <button (click)="effectuerRetrait()" class="btn-primary">Effectuer</button>
      </div>
    </div>
  </div>

  <!-- Modal Virement -->
  <div *ngIf="showVirementForm" class="modal-overlay" (click)="closeVirementForm()">
    <div class="modal" (click)="$event.stopPropagation()">
      <h3>â†”ï¸ Effectuer un virement</h3>
      <div class="form-group">
        <label>Compte source</label>
        <select [(ngModel)]="virementForm.compteSource">
          <option *ngFor="let compte of comptes" [value]="compte.numeroCompte">
            {{ compte.numeroCompte }} - {{ compte.typeCompte }}
          </option>
        </select>
      </div>
      <div class="form-group">
        <label>Compte destinataire (IBAN)</label>
        <input type="text" [(ngModel)]="virementForm.compteDestinataire" placeholder="FR76 1234 5678..." />
      </div>
      <div class="form-group">
        <label>Montant (â‚¬)</label>
        <input type="number" [(ngModel)]="virementForm.montant" min="0.01" step="0.01" />
      </div>
      <div class="form-group">
        <label>Description</label>
        <input type="text" [(ngModel)]="virementForm.description" placeholder="Optionnel" />
      </div>
      <div class="modal-actions">
        <button (click)="closeVirementForm()">Annuler</button>
        <button (click)="effectuerVirement()" class="btn-primary">Effectuer</button>
      </div>
    </div>
  </div>

  <!-- Modal CrÃ©ation compte -->
  <div *ngIf="showCreateAccountForm" class="modal-overlay" (click)="closeCreateAccountForm()">
    <div class="modal" (click)="$event.stopPropagation()">
      <h3>â• CrÃ©er un nouveau compte</h3>
      <div class="form-group">
        <label>Type de compte</label>
        <select [(ngModel)]="createAccountForm.typeCompte">
          <option value="COURANT">ğŸ¦ Compte Courant</option>
          <option value="EPARGNE">ğŸ’° Compte Ã‰pargne</option>
        </select>
      </div>
      <div class="info-note">
        <p>Le numÃ©ro IBAN sera gÃ©nÃ©rÃ© automatiquement</p>
        <p>Le solde initial sera de 0.00 â‚¬</p>
      </div>
      <div class="modal-actions">
        <button (click)="closeCreateAccountForm()">Annuler</button>
        <button (click)="creerCompte()" class="btn-primary">CrÃ©er</button>
      </div>
    </div>
  </div>

  <!-- Modal RelevÃ© -->
  <div *ngIf="showReleveForm" class="modal-overlay" (click)="closeReleveForm()">
    <div class="modal" (click)="$event.stopPropagation()">
      <h3>ğŸ“„ TÃ©lÃ©charger relevÃ© PDF</h3>
      <div class="form-group">
        <label>Compte</label>
        <select [(ngModel)]="releveForm.numeroCompte">
          <option *ngFor="let compte of comptes" [value]="compte.numeroCompte">
            {{ compte.numeroCompte }} - {{ compte.typeCompte }}
          </option>
        </select>
      </div>
      <div class="form-group">
        <label>Date de dÃ©but</label>
        <input type="date" [(ngModel)]="releveForm.dateDebut" />
      </div>
      <div class="form-group">
        <label>Date de fin</label>
        <input type="date" [(ngModel)]="releveForm.dateFin" />
      </div>
      <div class="modal-actions">
        <button (click)="closeReleveForm()">Annuler</button>
        <button (click)="downloadRelevePDF()" class="btn-primary">TÃ©lÃ©charger</button>
      </div>
    </div>
  </div>
</div>